<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>疑似特殊教育學生轉介前介入輔導紀錄表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .section-card {
            transition: all 0.3s ease;
        }
        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .tab-button {
            border-color: transparent;
            transition: all 0.3s ease;
            opacity: 0.7;
            font-size: 0.875rem;
        }
        .tab-button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab-button.active {
            opacity: 1;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
            font-size: 1.125rem;
            font-weight: 700;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-full">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 標題區域 -->
        <div class="text-center mb-8 fade-in">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">疑似特殊教育學生轉介前介入輔導紀錄表</h1>
            <p class="text-gray-600 text-lg">普通班教師專用評估工具</p>
        </div>

        <form id="assessmentForm" class="space-y-8">
            <!-- 第一部分：學生基本資料 -->
            <div class="section-card bg-white rounded-xl shadow-lg p-6 fade-in">
                <h2 class="text-2xl font-bold text-blue-700 mb-6 flex items-center">
                    <span class="bg-blue-100 rounded-full w-8 h-8 flex items-center justify-center text-blue-700 mr-3 text-sm font-bold">1</span>
                    學生基本資料
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">學生姓名 *</label>
                        <input type="text" id="studentName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" onblur="checkForSavedData()">
                        <div id="savedDataNotification" class="hidden mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                            <p class="text-blue-800 text-sm mb-2">找到此學生的已儲存資料</p>
                            <button type="button" onclick="loadSavedData()" class="px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 transition-colors mr-2">載入資料</button>
                            <button type="button" onclick="hideSavedDataNotification()" class="px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded hover:bg-gray-400 transition-colors">忽略</button>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">班級 *</label>
                        <input type="text" id="studentClass" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">座號</label>
                        <input type="text" id="studentId" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">教師輔導介入日期 *</label>
                        <input type="date" id="interventionDate" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">填表日期 *</label>
                        <input type="date" id="assessmentDate" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">填表教師 *</label>
                        <input type="text" id="teacherName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="請輸入您的姓名">
                    </div>
                </div>
            </div>

            <!-- 第二部分：檢核向度 -->
            <div class="section-card bg-white rounded-xl shadow-lg p-6 fade-in">
                <h2 class="text-2xl font-bold text-blue-700 mb-6 flex items-center">
                    <span class="bg-blue-100 rounded-full w-8 h-8 flex items-center justify-center text-blue-700 mr-3 text-sm font-bold">2</span>
                    檢核向度評估
                </h2>

                <!-- 分頁標籤 -->
                <div class="border-b border-gray-200 mb-6">
                    <nav class="-mb-px flex space-x-2 overflow-x-auto pb-2">
                        <button type="button" onclick="switchTab('classroomBehavior')" id="tab-classroomBehavior" class="tab-button active whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-orange-100 text-orange-800 rounded-t-lg">
                            班級常規表現
                        </button>
                        <button type="button" onclick="switchTab('emotionalBehavior')" id="tab-emotionalBehavior" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-red-100 text-red-800 rounded-t-lg">
                            情緒行為評估
                        </button>
                        <button type="button" onclick="switchTab('mentalHealth')" id="tab-mentalHealth" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-purple-100 text-purple-800 rounded-t-lg">
                            憂鬱焦慮評估
                        </button>
                        <button type="button" onclick="switchTab('interpersonal')" id="tab-interpersonal" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-teal-100 text-teal-800 rounded-t-lg">
                            人際關係評估
                        </button>
                        <button type="button" onclick="switchTab('communication')" id="tab-communication" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-indigo-100 text-indigo-800 rounded-t-lg">
                            溝通能力評估
                        </button>
                        <button type="button" onclick="switchTab('cognitive')" id="tab-cognitive" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-yellow-100 text-yellow-800 rounded-t-lg">
                            認知能力評估
                        </button>
                        <button type="button" onclick="switchTab('perceptualMotor')" id="tab-perceptualMotor" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-emerald-100 text-emerald-800 rounded-t-lg">
                            知覺動作評估
                        </button>
                        <button type="button" onclick="switchTab('chineseAbility')" id="tab-chineseAbility" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-blue-100 text-blue-800 rounded-t-lg">
                            國語能力評估
                        </button>
                        <button type="button" onclick="switchTab('mathAbility')" id="tab-mathAbility" class="tab-button whitespace-nowrap py-2 px-3 border-b-2 font-bold text-sm bg-cyan-100 text-cyan-800 rounded-t-lg">
                            數學能力評估
                        </button>
                    </nav>
                </div>

                <!-- 分頁內容 -->
                <div id="tabContent">
                    <!-- 動態生成的分頁內容將在這裡 -->
                </div>
            </div>

            <!-- 操作按鈕 -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center fade-in">
                <button type="button" onclick="exportData()" class="px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium shadow-lg hover:shadow-xl transform hover:scale-105">
                    📄 匯出評估報告
                </button>
                <button type="button" onclick="manageSavedData()" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-lg hover:shadow-xl transform hover:scale-105">
                    📂 管理已儲存資料
                </button>
                <button type="button" onclick="resetForm()" class="px-8 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium">
                    🔄 重新填寫
                </button>
            </div>
        </form>
    </div>

    <script>
        // 評估向度資料
        const dimensions = {
            classroomBehavior: { 
                id: 'classroomBehavior', 
                title: '一、班級常規表現', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.發呆',
                    '02.趴桌或睡覺', 
                    '03.東張西望',
                    '04.玩弄物品',
                    '05.坐立不安、扭動身體',
                    '06.時常離開座位',
                    '07.經常跑來跑去、爬上爬下',
                    '08.無法安靜的玩遊戲或從事活動',
                    '09.注意力容易被打斷或轉移',
                    '10.容易掉以輕心，出現無心的錯誤',
                    '11.常無法完成指定的功課或工作',
                    '12.經常丟掉日常必需的東西',
                    '13.經常忘記日常的事物',
                    '14.口無遮攔，話閘子打開講個沒完',
                    '15.沒有辦法等待或問題還沒聽清楚就搶先發言回答',
                    '16.學習低成就',
                    '17.學習態度消極',
                    '18.學習活動參與度少',
                    '19.對學習不感興趣',
                    '20.經常曠課或遲到',
                    '21.明顯的退縮及逃避的行為',
                    '22.經常表示身體不適',
                    '23.不切實際的目標',
                    '其他（請說明）'
                ]
            },
            emotionalBehavior: { 
                id: 'emotionalBehavior', 
                title: '二、情緒行為、攻擊暴力、干擾反抗行為', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.冷漠、不理會他人',
                    '02.沉默不語，完全不表示意見',
                    '03.重複性的行為',
                    '04.不自主口語',
                    '05.不自主動作',
                    '06.發出怪聲',
                    '07.自言自語',
                    '08.製造噪音',
                    '09.尖叫',
                    '10.哭鬧行為',
                    '11.大發脾氣',
                    '12.激烈憤怒',
                    '13.一點小事便很容易憤怒',
                    '14.一旦發脾氣就難平靜下來',
                    '15.身體的攻擊',
                    '16.罵人',
                    '17.語言挑釁',
                    '18.虐待動物',
                    '19.破壞物品',
                    '20.不法行為',
                    '21.自傷行為',
                    '22.企圖自殺',
                    '23.公然反抗或不聽從指示或規定',
                    '24.和大人吵嘴',
                    '25.故意擾亂觸怒他人',
                    '26.把自己的過錯歸咎於別人',
                    '其他（請說明）'
                ]
            },
            mentalHealth: { 
                id: 'mentalHealth', 
                title: '三、憂鬱、躁症、焦慮或恐懼行為', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.憂鬱、躁症或躁鬱的情緒',
                    '02.對日常生活事物失去興趣',
                    '03.食慾異常地增加或減少',
                    '04.失眠或是睡眠過多',
                    '05.精力不足、疲憊不堪',
                    '06.精力過度旺盛、煩躁不安',
                    '07.出現反常的行為',
                    '08.缺乏自尊自信',
                    '09.精神恍惚、不能做決定',
                    '10.覺得自己一無是處、毫無希望',
                    '11.動作反應過度激烈或遲鈍',
                    '12.湧現自殺或死亡的念頭',
                    '13.出現幻覺或妄想的行為',
                    '14.過度追求完美，無法接受失敗',
                    '15.嚴重懼怕行為',
                    '16.嚴重懼怕社交',
                    '17.有嚴重分離焦慮行為',
                    '18.焦慮行為',
                    '19.有嚴重的強迫行為',
                    '其他（請說明）'
                ]
            },
            interpersonal: { 
                id: 'interpersonal', 
                title: '四、人際關係', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.情緒不穩定',
                    '02.常與人爭執',
                    '03.挫折容忍度低',
                    '04.不能等待，經常打斷別人談話',
                    '05.以不當身體接觸與人溝通',
                    '06.很少主動與人談話',
                    '07.社交技巧差',
                    '08.不與他人接觸',
                    '其他（請說明）'
                ]
            },
            communication: { 
                id: 'communication', 
                title: '五、溝通能力', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.只能懂日常語彙',
                    '02.無法聽懂指示',
                    '03.無法理解談話內容',
                    '04.聽的懂語句但無法理解抽象內容',
                    '05.易誤解指示',
                    '06.指令只聽一半',
                    '07.常需重覆問題',
                    '其他（請說明）'
                ]
            },
            cognitive: { 
                id: 'cognitive', 
                title: '六、認知能力', 
                type: 'checkbox',
                subCategories: {
                    attention: {
                        title: '(一)注意力',
                        options: [
                            '無以下問題',
                            '01.注意力不集中超過 15 分鐘',
                            '02.坐立不安',
                            '03.容易因外界而分心',
                            '04.把玩東西或逗弄其他人或物',
                            '05.注意力分散、恍惚失神',
                            '06.離開座位或走動',
                            '07.不能注意細節'
                        ]
                    },
                    memory: {
                        title: '(二)記憶力',
                        options: [
                            '無以下問題',
                            '01.過目即忘',
                            '02.今天教明天忘',
                            '03.需要反覆練習才記得',
                            '04.經常忘東忘西',
                            '05.長期記憶弱',
                            '06.能記得有興趣的事情'
                        ]
                    },
                    thinking: {
                        title: '(三)思考力',
                        options: [
                            '無以下問題',
                            '01.邏輯概念差',
                            '02.推理能力弱',
                            '03.問題解決能力弱',
                            '04.不喜歡思考',
                            '05.因果關係概念差'
                        ]
                    }
                }
            },
            perceptualMotor: { 
                id: 'perceptualMotor', 
                title: '七、知覺動作', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.動作笨拙、遲緩',
                    '02.辨識聲音方向或大小有困難',
                    '03.視覺空間方向辨識困難',
                    '04.經常跌倒或碰撞',
                    '05.經常弄壞東西',
                    '06.精細動作差',
                    '07.韻律感差',
                    '其他（請說明）'
                ]
            },
            chineseAbility: { 
                id: 'chineseAbility', 
                title: '八、國語能力', 
                type: 'checkbox',
                subCategories: {
                    reading: {
                        title: '(一)閱讀',
                        options: [
                            '無以下問題',
                            '01.識字少',
                            '02.會讀字句但不懂意思',
                            '03.閱讀緩慢',
                            '04.斷字斷句易錯',
                            '05.讀時會跳行跳字',
                            '06.易增/漏字'
                        ]
                    },
                    phonics: {
                        title: '(二)拼音',
                        options: [
                            '無以下問題',
                            '01.注音符號認讀困難',
                            '02.拼音困難',
                            '03.聲調辨識困難',
                            '04.拼音聽寫困難',
                            '05.構音異常'
                        ]
                    },
                    writing: {
                        title: '(三)寫字',
                        options: [
                            '無以下問題',
                            '01.寫字速度慢',
                            '02.抄寫速度慢、易出錯',
                            '03.筆順錯誤',
                            '04.寫字超出格子',
                            '05.鏡體字',
                            '06.筆畫缺漏',
                            '07.仿寫困難',
                            '08.聽寫困難',
                            '09.遠距抄寫速度慢',
                            '10.字體大小不一',
                            '11.易寫錯字形相似字',
                            '12.同音異字易錯',
                            '13.字體潦草'
                        ]
                    },
                    composition: {
                        title: '(四)寫作',
                        options: [
                            '無以下問題',
                            '01.造詞困難',
                            '02.造句困難',
                            '03.詞彙缺乏',
                            '04.注音替代國字',
                            '05.篇幅太短',
                            '06.表達不切主題',
                            '07.語句不通順'
                        ]
                    }
                }
            },
            mathAbility: { 
                id: 'mathAbility', 
                title: '九、數學能力', 
                type: 'checkbox',
                options: [
                    '無以下問題',
                    '01.數字辨認有困難',
                    '02.加減計算有困難',
                    '03.數數字有困難',
                    '04.乘除計算有困難',
                    '05.九九乘法背誦有困難',
                    '06.四則運算有困難',
                    '07.「比較」概念差',
                    '08.缺乏心算能力',
                    '09.單位換算困難',
                    '10.缺乏數量概念',
                    '11.符號辨識困難',
                    '12.推理能力差',
                    '13.形狀辨認有困難',
                    '14.應用問題題意理解困難',
                    '15.空間方向辨識困難',
                    '16.時間概念理解困難'
                ]
            },

        };

        // 初始化表單
        function initializeForm() {
            createTabContent();
            switchTab('classroomBehavior'); // 預設顯示第一個分頁
            
            // 設定今天的日期為預設值
            document.getElementById('assessmentDate').valueAsDate = new Date();
        }

        // 創建分頁內容
        function createTabContent() {
            const container = document.getElementById('tabContent');
            
            // 班級常規表現分頁
            const classroomTab = createClassroomBehaviorTab();
            
            // 情緒行為評估分頁
            const emotionalTab = createEmotionalBehaviorTab();
            
            // 憂鬱焦慮評估分頁
            const mentalHealthTab = createMentalHealthTab();
            
            // 人際關係評估分頁
            const interpersonalTab = createInterpersonalTab();
            
            // 溝通能力評估分頁
            const communicationTab = createCommunicationTab();
            
            // 認知能力評估分頁
            const cognitiveTab = createCognitiveTab();
            
            // 知覺動作評估分頁
            const perceptualMotorTab = createPerceptualMotorTab();
            
            // 國語能力評估分頁
            const chineseAbilityTab = createChineseAbilityTab();
            
            // 數學能力評估分頁
            const mathAbilityTab = createMathAbilityTab();
            
            container.innerHTML = classroomTab + emotionalTab + mentalHealthTab + interpersonalTab + communicationTab + cognitiveTab + perceptualMotorTab + chineseAbilityTab + mathAbilityTab;
        }

        // 創建班級常規表現分頁
        function createClassroomBehaviorTab() {
            const dimension = dimensions.classroomBehavior;
            return `
                <div id="content-classroomBehavior" class="tab-content active">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：班級常規檢核 -->
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-orange-800 mb-3">班級常規檢核</h4>
                                <div class="space-y-1 max-h-80 overflow-y-auto pr-2">
                                    ${dimension.options.map((option, optionIndex) => `
                                        <div>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-orange-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-orange-600 focus:ring-orange-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                            </label>
                                            ${option.includes('其他') ? `
                                                <input type="text" name="${dimension.id}_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                    
                                    <!-- 其他補充欄位 -->
                                    <div class="mt-4 pt-3 border-t border-orange-200">
                                        <label class="block text-sm font-medium text-orange-800 mb-2">其他補充問題：</label>
                                        <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：介入輔導方式 -->
                            ${createInterventionMethods()}
                        </div>
                        
                        <div id="${dimension.id}_other" class="hidden mt-4">
                            <label class="block text-gray-700 font-medium mb-2">請說明：</label>
                            <textarea name="${dimension.id}_text" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明..."></textarea>
                        </div>
                        

                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建情緒行為評估分頁
        function createEmotionalBehaviorTab() {
            const dimension = dimensions.emotionalBehavior;
            return `
                <div id="content-emotionalBehavior" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：情緒行為檢核 -->
                            <div class="bg-red-50 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-red-800 mb-3">情緒行為檢核</h4>
                                <div class="space-y-1 max-h-80 overflow-y-auto pr-2">
                                    ${dimension.options.map((option, optionIndex) => `
                                        <div>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-red-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-red-600 focus:ring-red-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                            </label>
                                            ${option.includes('其他') ? `
                                                <input type="text" name="${dimension.id}_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                    
                                    <!-- 其他補充欄位 -->
                                    <div class="mt-4 pt-3 border-t border-red-200">
                                        <label class="block text-sm font-medium text-red-800 mb-2">其他補充問題：</label>
                                        <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：行為管理策略 -->
                            ${createBehaviorManagementStrategies()}
                        </div>
                        
                        <div id="${dimension.id}_other" class="hidden mt-4">
                            <label class="block text-gray-700 font-medium mb-2">請說明：</label>
                            <textarea name="${dimension.id}_text" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明..."></textarea>
                        </div>
                        

                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建憂鬱焦慮評估分頁
        function createMentalHealthTab() {
            const dimension = dimensions.mentalHealth;
            return `
                <div id="content-mentalHealth" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：憂鬱焦慮檢核 -->
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-purple-800 mb-3">憂鬱焦慮檢核</h4>
                                <div class="space-y-1 max-h-80 overflow-y-auto pr-2">
                                    ${dimension.options.map((option, optionIndex) => `
                                        <div>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-purple-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-purple-600 focus:ring-purple-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                            </label>
                                            ${option.includes('其他') ? `
                                                <input type="text" name="${dimension.id}_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                    
                                    <!-- 其他補充欄位 -->
                                    <div class="mt-4 pt-3 border-t border-purple-200">
                                        <label class="block text-sm font-medium text-purple-800 mb-2">其他補充問題：</label>
                                        <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：心理健康支持策略 -->
                            ${createMentalHealthStrategies()}
                        </div>
                        
                        <div id="${dimension.id}_other" class="hidden mt-4">
                            <label class="block text-gray-700 font-medium mb-2">請說明：</label>
                            <textarea name="${dimension.id}_text" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明..."></textarea>
                        </div>
                        

                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建人際關係評估分頁
        function createInterpersonalTab() {
            const dimension = dimensions.interpersonal;
            return `
                <div id="content-interpersonal" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：人際關係檢核 -->
                            <div class="bg-teal-50 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-teal-800 mb-3">人際關係檢核</h4>
                                <div class="space-y-1 max-h-80 overflow-y-auto pr-2">
                                    ${dimension.options.map((option, optionIndex) => `
                                        <div>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-teal-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-teal-600 focus:ring-teal-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                            </label>
                                            ${option.includes('其他') ? `
                                                <input type="text" name="${dimension.id}_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                    
                                    <!-- 其他補充欄位 -->
                                    <div class="mt-4 pt-3 border-t border-teal-200">
                                        <label class="block text-sm font-medium text-teal-800 mb-2">其他補充問題：</label>
                                        <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：社會技巧策略 -->
                            ${createSocialSkillsStrategies()}
                        </div>
                        
                        <div id="${dimension.id}_other" class="hidden mt-4">
                            <label class="block text-gray-700 font-medium mb-2">請說明：</label>
                            <textarea name="${dimension.id}_text" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明..."></textarea>
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_interpersonal_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他人際關係支持策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建溝通能力評估分頁
        function createCommunicationTab() {
            const dimension = dimensions.communication;
            return `
                <div id="content-communication" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：溝通能力檢核 -->
                            <div class="bg-indigo-50 p-4 rounded-lg space-y-4">
                                <!-- 聽覺理解 -->
                                <div>
                                    <h4 class="text-md font-medium text-indigo-800 mb-3">(一)聽覺理解</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                                ${option.includes('其他') ? `
                                                    <input type="text" name="${dimension.id}_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                                ` : ''}
                                            </div>
                                        `).join('')}
                                        
                                        <!-- 其他補充欄位 -->
                                        <div class="mt-4 pt-3 border-t border-indigo-200">
                                            <label class="block text-sm font-medium text-indigo-800 mb-2">其他補充問題：</label>
                                            <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 口語表達 -->
                                <div class="border-t border-indigo-200 pt-4">
                                    <h4 class="text-md font-medium text-indigo-800 mb-3">(二)口語表達</h4>
                                    
                                    <!-- 慣用語言 -->
                                    <div class="mb-3">
                                        <h5 class="text-sm font-medium text-indigo-700 mb-2">慣用語言：</h5>
                                        <div class="grid grid-cols-2 gap-2">
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="preferred_language_mandarin" value="國語" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">國語</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="preferred_language_hakka" value="客語" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">客語</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="preferred_language_taiwanese" value="台語" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">台語</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="preferred_language_indigenous" value="原住民語言" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">原住民語言</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="preferred_language_other" value="其他" class="text-indigo-600 focus:ring-indigo-500" onchange="toggleOtherInput('preferred_language_other_text', this.checked)">
                                                <span class="text-sm text-gray-700">其他</span>
                                            </label>
                                        </div>
                                        <input type="text" name="preferred_language_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded mt-2 hidden" placeholder="請說明其他語言...">
                                    </div>
                                    
                                    <!-- 非口語溝通 -->
                                    <div class="mb-3">
                                        <h5 class="text-sm font-medium text-indigo-700 mb-2">非口語溝通：</h5>
                                        <div class="grid grid-cols-2 gap-2">
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="nonverbal_gesture" value="手勢" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">手勢</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="nonverbal_writing" value="書寫" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">書寫</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="nonverbal_expression" value="表情" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">表情</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="nonverbal_nodding" value="點頭" class="text-indigo-600 focus:ring-indigo-500">
                                                <span class="text-sm text-gray-700">點頭</span>
                                            </label>
                                            <label class="flex items-center space-x-2 cursor-pointer">
                                                <input type="checkbox" name="nonverbal_other" value="其他" class="text-indigo-600 focus:ring-indigo-500" onchange="toggleOtherInput('nonverbal_other_text', this.checked)">
                                                <span class="text-sm text-gray-700">其他</span>
                                            </label>
                                        </div>
                                        <input type="text" name="nonverbal_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded mt-2 hidden" placeholder="請說明其他非口語溝通方式...">
                                    </div>
                                    
                                    <!-- 口語表達問題檢核 -->
                                    <div>
                                        <h5 class="text-sm font-medium text-indigo-700 mb-2">口語表達問題：</h5>
                                        <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_0" value="無以下問題" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('無以下問題', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">無以下問題</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_1" value="01.經常自言自語" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('01.經常自言自語', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">01.經常自言自語</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_2" value="02.不知所云、答非所問" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('02.不知所云、答非所問', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">02.不知所云、答非所問</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_3" value="03.構音異常" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('03.構音異常', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">03.構音異常</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_4" value="04.很少主動與人談話" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('04.很少主動與人談話', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">04.很少主動與人談話</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_5" value="05.語彙少" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('05.語彙少', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">05.語彙少</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_6" value="06.以不當身體接觸與人溝通" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('06.以不當身體接觸與人溝通', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">06.以不當身體接觸與人溝通</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_7" value="07.說話不流暢" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('07.說話不流暢', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">07.說話不流暢</span>
                                            </label>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-indigo-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="oral_expression_8" value="08.選擇性說話－只與特定對象說話" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="handleOralExpressionChange('08.選擇性說話－只與特定對象說話', this.checked)">
                                                <span class="text-sm text-gray-700 leading-relaxed">08.選擇性說話－只與特定對象說話</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：溝通訓練策略 -->
                            ${createCommunicationTrainingStrategies()}
                        </div>
                        
                        <div id="${dimension.id}_other" class="hidden mt-4">
                            <label class="block text-gray-700 font-medium mb-2">請說明：</label>
                            <textarea name="${dimension.id}_text" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明..."></textarea>
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_communication_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他溝通訓練策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建認知能力評估分頁
        function createCognitiveTab() {
            const dimension = dimensions.cognitive;
            return `
                <div id="content-cognitive" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：認知能力檢核 -->
                            <div class="space-y-6">
                                <!-- 注意力 -->
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-orange-800 mb-3">${dimension.subCategories.attention.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.attention.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-orange-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="attention_${optionIndex}" value="${option}" class="text-orange-600 focus:ring-orange-500 mt-1" onchange="handleCognitiveOptionChange('attention', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <!-- 記憶力 -->
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-blue-800 mb-3">${dimension.subCategories.memory.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.memory.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-blue-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="memory_${optionIndex}" value="${option}" class="text-blue-600 focus:ring-blue-500 mt-1" onchange="handleCognitiveOptionChange('memory', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <!-- 思考力 -->
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-purple-800 mb-3">${dimension.subCategories.thinking.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.thinking.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-purple-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="thinking_${optionIndex}" value="${option}" class="text-purple-600 focus:ring-purple-500 mt-1" onchange="handleCognitiveOptionChange('thinking', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                                ${option.includes('其他') ? `
                                                    <input type="text" name="thinking_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                                ` : ''}
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：教學調整策略 -->
                            ${createCognitiveStrategies()}
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg mt-6">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_cognitive_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他認知能力支持策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建知覺動作評估分頁
        function createPerceptualMotorTab() {
            const dimension = dimensions.perceptualMotor;
            return `
                <div id="content-perceptualMotor" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：知覺動作檢核 -->
                            <div class="bg-emerald-50 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-emerald-800 mb-3">知覺動作檢核</h4>
                                <div class="space-y-1 max-h-80 overflow-y-auto pr-2">
                                    ${dimension.options.map((option, optionIndex) => `
                                        <div>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-emerald-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-emerald-600 focus:ring-emerald-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                            </label>
                                            ${option.includes('其他') ? `
                                                <input type="text" name="${dimension.id}_other_${optionIndex}_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded ml-6 mt-1 hidden" placeholder="請說明...">
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                    
                                    <!-- 其他補充欄位 -->
                                    <div class="mt-4 pt-3 border-t border-emerald-200">
                                        <label class="block text-sm font-medium text-emerald-800 mb-2">其他補充問題：</label>
                                        <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：功能性動作訓練策略 -->
                            ${createPerceptualMotorStrategies()}
                        </div>
                        
                        <div id="${dimension.id}_other" class="hidden mt-4">
                            <label class="block text-gray-700 font-medium mb-2">請說明：</label>
                            <textarea name="${dimension.id}_text" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明..."></textarea>
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg mt-6">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_perceptual_motor_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他知覺動作訓練策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建國語能力評估分頁
        function createChineseAbilityTab() {
            const dimension = dimensions.chineseAbility;
            return `
                <div id="content-chineseAbility" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：國語能力檢核 -->
                            <div class="space-y-6">
                                <!-- 閱讀 -->
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-blue-800 mb-3">${dimension.subCategories.reading.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.reading.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-blue-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="reading_${optionIndex}" value="${option}" class="text-blue-600 focus:ring-blue-500 mt-1" onchange="handleChineseAbilityOptionChange('reading', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <!-- 拼音 -->
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-green-800 mb-3">${dimension.subCategories.phonics.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.phonics.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-green-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="phonics_${optionIndex}" value="${option}" class="text-green-600 focus:ring-green-500 mt-1" onchange="handleChineseAbilityOptionChange('phonics', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                                ${option === '01.注音符號認讀困難' ? `
                                                    <div class="ml-6 mt-2 space-y-1">
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_recognition_consonant" value="聲符" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">聲符</span>
                                                        </label>
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_recognition_vowel" value="韻符" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">韻符</span>
                                                        </label>
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_recognition_combination" value="結合符" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">結合符</span>
                                                        </label>
                                                    </div>
                                                ` : ''}
                                                ${option === '02.拼音困難' ? `
                                                    <div class="ml-6 mt-2 space-y-1">
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_difficulty_double" value="雙拼" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">雙拼</span>
                                                        </label>
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_difficulty_triple" value="三拼" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">三拼</span>
                                                        </label>
                                                    </div>
                                                ` : ''}
                                                ${option === '04.拼音聽寫困難' ? `
                                                    <div class="ml-6 mt-2 space-y-1">
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_dictation_double" value="雙拼" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">雙拼</span>
                                                        </label>
                                                        <label class="flex items-center space-x-2 cursor-pointer">
                                                            <input type="checkbox" name="phonics_dictation_triple" value="三拼" class="text-green-600 focus:ring-green-500">
                                                            <span class="text-xs text-gray-600">三拼</span>
                                                        </label>
                                                    </div>
                                                ` : ''}
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <!-- 寫字 -->
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-purple-800 mb-3">${dimension.subCategories.writing.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.writing.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-purple-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="writing_${optionIndex}" value="${option}" class="text-purple-600 focus:ring-purple-500 mt-1" onchange="handleChineseAbilityOptionChange('writing', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <!-- 寫作 -->
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="text-md font-medium text-orange-800 mb-3">${dimension.subCategories.composition.title}</h4>
                                    <div class="space-y-1 max-h-40 overflow-y-auto pr-2">
                                        ${dimension.subCategories.composition.options.map((option, optionIndex) => `
                                            <div>
                                                <label class="flex items-start space-x-2 cursor-pointer hover:bg-orange-100 p-2 rounded transition-colors">
                                                    <input type="checkbox" name="composition_${optionIndex}" value="${option}" class="text-orange-600 focus:ring-orange-500 mt-1" onchange="handleChineseAbilityOptionChange('composition', '${option}', ${optionIndex})">
                                                    <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                                </label>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：國語學習策略 -->
                            ${createChineseAbilityStrategies()}
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg mt-6">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_chinese_ability_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他國語能力支持策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建數學能力評估分頁
        function createMathAbilityTab() {
            const dimension = dimensions.mathAbility;
            return `
                <div id="content-mathAbility" class="tab-content">
                    <div class="border border-gray-200 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">${dimension.title}</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側：數學能力檢核 -->
                            <div class="bg-cyan-50 p-4 rounded-lg">
                                <h4 class="text-md font-medium text-cyan-800 mb-3">數學能力檢核</h4>
                                <div class="space-y-1 max-h-80 overflow-y-auto pr-2">
                                    ${dimension.options.map((option, optionIndex) => `
                                        <div>
                                            <label class="flex items-start space-x-2 cursor-pointer hover:bg-cyan-100 p-2 rounded transition-colors">
                                                <input type="checkbox" name="${dimension.id}_${optionIndex}" value="${option}" class="text-cyan-600 focus:ring-cyan-500 mt-1" onchange="handleOptionChange('${dimension.id}', '${option}', true, ${optionIndex})">
                                                <span class="text-sm text-gray-700 leading-relaxed">${option}</span>
                                            </label>
                                        </div>
                                    `).join('')}
                                    
                                    <!-- 其他補充欄位 -->
                                    <div class="mt-4 pt-3 border-t border-cyan-200">
                                        <label class="block text-sm font-medium text-cyan-800 mb-2">其他補充問題：</label>
                                        <textarea name="${dimension.id}_additional_notes" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all resize-none" placeholder="請補充其他觀察到的問題或行為..."></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 右側：數學學習策略 -->
                            ${createMathAbilityStrategies()}
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg mt-6">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_math_ability_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他數學能力支持策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-gray-700 font-medium mb-2">相關照片或文件（選填）</label>
                            <input type="file" name="${dimension.id}_file" accept="image/*,.pdf,.doc,.docx" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <!-- 存檔按鈕 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <button type="button" onclick="saveCurrentData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                💾 儲存目前資料
                            </button>
                            <p class="text-xs text-gray-500 mt-1">資料會儲存在此電腦上，下次輸入相同學生姓名時可載入</p>
                        </div>
                        
                    </div>
                </div>
            `;
        }



        // 分頁切換功能
        function switchTab(tabId) {
            // 隱藏所有分頁內容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // 移除所有分頁按鈕的 active 狀態
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // 顯示選中的分頁內容
            const targetContent = document.getElementById('content-' + tabId);
            if (targetContent) {
                targetContent.classList.add('active');
            }
            
            // 設定選中的分頁按鈕為 active
            const targetButton = document.getElementById('tab-' + tabId);
            if (targetButton) {
                targetButton.classList.add('active');
            }
        }

        // 創建介入輔導方式內容
        function createInterventionMethods() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 課業輔導 -->
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h5 class="font-medium text-blue-800 mb-2">課業輔導</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_1" value="提高學習動機" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">提高學習動機</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_2" value="補救教學" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">補救教學</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_3" value="提供多元學習機會" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">提供多元學習機會</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_4" value="提供選擇機會，彈性學習" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">提供選擇機會，彈性學習</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_5" value="建立成功的學習經驗" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">建立成功的學習經驗</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_6" value="作業切割成數個小部分完成" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">作業切割成數個小部分完成</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="academic_support_other" value="其他" class="text-blue-600 focus:ring-blue-500 mt-1" onchange="toggleOtherInput('academic_support_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="academic_support_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                        
                        <!-- 多層次教學 -->
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h5 class="font-medium text-green-800 mb-2">多層次教學</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_1" value="言詞提醒" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">言詞提醒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_2" value="動作提醒" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">動作提醒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_3" value="手勢提醒" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">手勢提醒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_4" value="標記重點" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">標記重點</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_5" value="安排有利座位" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">安排有利座位</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_6" value="安排安靜適合學習的教學環境" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">安排安靜適合學習的教學環境</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_7" value="頻繁、立即的回饋" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">頻繁、立即的回饋</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_8" value="使用有趣的教學道具、方式" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">使用有趣的教學道具、方式</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_9" value="提供成功機會給予鼓勵" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">提供成功機會給予鼓勵</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_10" value="確定四目相對後給予指令" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">確定四目相對後給予指令</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_11" value="轉移注意力" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">轉移注意力</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_12" value="建立及提升學習自信" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">建立及提升學習自信</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_13" value="給與工作任務，給予成功經驗" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">給與工作任務，給予成功經驗</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="multilevel_teaching_other" value="其他" class="text-green-600 focus:ring-green-500 mt-1" onchange="toggleOtherInput('multilevel_teaching_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="multilevel_teaching_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                        
                        <!-- 親職教育 -->
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h5 class="font-medium text-purple-800 mb-2">親職教育</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_1" value="規律的日常作息" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">規律的日常作息</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_2" value="規律的服藥及就醫" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">規律的服藥及就醫</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_3" value="親師溝通、家庭訪問" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">親師溝通、家庭訪問</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_other" value="其他" class="text-purple-600 focus:ring-purple-500 mt-1" onchange="toggleOtherInput('parent_education_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="parent_education_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                        
                        <!-- 其他策略 -->
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h5 class="font-medium text-yellow-800 mb-2">其他策略</h5>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">策略說明：</label>
                                    <textarea name="other_strategy_description" rows="3" class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all resize-none" placeholder="請詳細說明使用過的其他介入策略..."></textarea>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建心理健康支持策略內容
        function createMentalHealthStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 親職教育 -->
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h5 class="font-medium text-blue-800 mb-2">親職教育</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_1" value="建議家長對兒童行為管理" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">建議家長對兒童行為管理</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_2" value="提供教養策略" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">提供教養策略</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_3" value="使家長瞭解個案的問題及提供可採取的方法" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">使家長瞭解個案的問題及提供可採取的方法</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_4" value="親師合作，管教一致" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">親師合作，管教一致</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_5" value="培養規律的日常作息" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">培養規律的日常作息</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_6" value="規律的服藥及就醫" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">規律的服藥及就醫</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="parent_education_mental_7" value="建議適當的飲食" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">建議適當的飲食</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 專業介入 -->
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h5 class="font-medium text-green-800 mb-2">專業介入</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="professional_intervention_1" value="建議家長尋求醫療評估" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">建議家長尋求醫療評估</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="professional_intervention_2" value="專業諮商輔導" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">專業諮商輔導</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="professional_intervention_3" value="心理治療" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">心理治療</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="professional_intervention_4" value="職能治療" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">職能治療</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="professional_intervention_5" value="團體治療" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">團體治療</span>
                                </label>
                            </div>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 創建溝通訓練策略內容
        function createCommunicationTrainingStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 溝通訓練 -->
                        <div class="bg-violet-50 p-4 rounded-lg">
                            <h5 class="font-medium text-violet-800 mb-2">溝通訓練</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_1" value="要求重述指示" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">要求重述指示</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_2" value="書寫時搭配口語解說" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">書寫時搭配口語解說</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_3" value="要求重點摘要" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">要求重點摘要</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_4" value="用多種感官模式教學" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">用多種感官模式教學</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_5" value="問題引導" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">問題引導</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_6" value="將關鍵字彙寫在黑板上" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">將關鍵字彙寫在黑板上</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_7" value="複述重點" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">複述重點</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_8" value="寫下重點" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">寫下重點</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_9" value="多提供口語表達練習機會" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">多提供口語表達練習機會</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_10" value="鼓勵多發言" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">鼓勵多發言</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_11" value="給予較多回答時間" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">給予較多回答時間</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_12" value="提醒表達切中主題" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">提醒表達切中主題</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_13" value="示範正確的表達方式並請他複誦一次" class="text-violet-600 focus:ring-violet-500 mt-1">
                                    <span class="text-sm text-gray-700">示範正確的表達方式並請他複誦一次</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="communication_training_other" value="其他" class="text-violet-600 focus:ring-violet-500 mt-1" onchange="toggleOtherInput('communication_training_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="communication_training_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 創建社會技巧策略內容
        function createSocialSkillsStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 社會技巧 -->
                        <div class="bg-cyan-50 p-4 rounded-lg">
                            <h5 class="font-medium text-cyan-800 mb-2">社會技巧</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_1" value="直接指導社交行為" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">直接指導社交行為</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_2" value="提供社交技巧練習" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">提供社交技巧練習</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_3" value="安排同儕協助" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">安排同儕協助</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_4" value="鼓勵與人多接觸" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">鼓勵與人多接觸</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_5" value="團體輔導" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">團體輔導</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_6" value="多讚美學生正向積極的行為" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">多讚美學生正向積極的行為</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_7" value="個別輔導" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">個別輔導</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_8" value="建立同理心" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">建立同理心</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_9" value="情緒轉移" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">情緒轉移</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_10" value="建立同儕活動" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">建立同儕活動</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_11" value="教導察覺他人情緒" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">教導察覺他人情緒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_12" value="教導情境處理" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">教導情境處理</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_13" value="培養以幽默方式面對問題" class="text-cyan-600 focus:ring-cyan-500 mt-1">
                                    <span class="text-sm text-gray-700">培養以幽默方式面對問題</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="social_skills_other" value="其他" class="text-cyan-600 focus:ring-cyan-500 mt-1" onchange="toggleOtherInput('social_skills_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="social_skills_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 創建知覺動作策略內容
        function createPerceptualMotorStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 功能性動作訓練 -->
                        <div class="bg-rose-50 p-4 rounded-lg">
                            <h5 class="font-medium text-rose-800 mb-2">功能性動作訓練</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="functional_motor_training_1" value="大肌肉動作訓練" class="text-rose-600 focus:ring-rose-500 mt-1">
                                    <span class="text-sm text-gray-700">大肌肉動作訓練</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="functional_motor_training_2" value="小肌肉動作訓練" class="text-rose-600 focus:ring-rose-500 mt-1">
                                    <span class="text-sm text-gray-700">小肌肉動作訓練</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="functional_motor_training_3" value="韻律活動" class="text-rose-600 focus:ring-rose-500 mt-1">
                                    <span class="text-sm text-gray-700">韻律活動</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="functional_motor_training_4" value="視覺敏銳度訓練" class="text-rose-600 focus:ring-rose-500 mt-1">
                                    <span class="text-sm text-gray-700">視覺敏銳度訓練</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="functional_motor_training_5" value="視覺動作空間形式處理訓練（跳過障礙物、繞物行走、堆疊積木）" class="text-rose-600 focus:ring-rose-500 mt-1">
                                    <span class="text-sm text-gray-700">視覺動作空間形式處理訓練（跳過障礙物、繞物行走、堆疊積木）</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="functional_motor_training_other" value="其他" class="text-rose-600 focus:ring-rose-500 mt-1" onchange="toggleOtherInput('functional_motor_training_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="functional_motor_training_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 創建國語能力策略內容
        function createChineseAbilityStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 閱讀學習策略 -->
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h5 class="font-medium text-blue-800 mb-2">閱讀學習策略</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="reading_strategy_1" value="簡化閱讀內容" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">簡化閱讀內容</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="reading_strategy_2" value="說出或寫出大意、心得" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">說出或寫出大意、心得</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="reading_strategy_3" value="利用問答方式提醒文章的重點" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">利用問答方式提醒文章的重點</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="reading_strategy_4" value="分段閱讀" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">分段閱讀</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="reading_strategy_5" value="練習圈選關鍵字" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">練習圈選關鍵字</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="reading_strategy_6" value="先以口語報讀再自行閱讀" class="text-blue-600 focus:ring-blue-500 mt-1">
                                    <span class="text-sm text-gray-700">先以口語報讀再自行閱讀</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 拼音學習策略 -->
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h5 class="font-medium text-green-800 mb-2">拼音學習策略</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="phonics_strategy_1" value="上課時提醒正確拼音" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">上課時提醒正確拼音</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="phonics_strategy_2" value="提供練習機會" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">提供練習機會</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="phonics_strategy_3" value="鼓勵多說多寫" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">鼓勵多說多寫</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="phonics_strategy_4" value="提供拼音教材" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">提供拼音教材</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="phonics_strategy_5" value="提供自然拼音" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">提供自然拼音</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="phonics_strategy_6" value="給予口語提示" class="text-green-600 focus:ring-green-500 mt-1">
                                    <span class="text-sm text-gray-700">給予口語提示</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 寫字學習策略 -->
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h5 class="font-medium text-purple-800 mb-2">寫字學習策略</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="writing_strategy_1" value="提供寫字結構格子練習" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">提供寫字結構格子練習</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="writing_strategy_2" value="反覆練習" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">反覆練習</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="writing_strategy_3" value="以顏色標出字的結構" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">以顏色標出字的結構</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="writing_strategy_4" value="提醒錯字" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">提醒錯字</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="writing_strategy_5" value="減少作業量" class="text-purple-600 focus:ring-purple-500 mt-1">
                                    <span class="text-sm text-gray-700">減少作業量</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 寫作學習策略 -->
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <h5 class="font-medium text-orange-800 mb-2">寫作學習策略</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_1" value="提供寫作結構提示" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">提供寫作結構提示</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_2" value="提供短句練習" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">提供短句練習</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_3" value="聯絡簿課外閱讀心得寫作" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">聯絡簿課外閱讀心得寫作</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_4" value="增加成語量" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">增加成語量</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_5" value="提供看圖寫故事練習" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">提供看圖寫故事練習</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_6" value="允許參考範例" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">允許參考範例</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="composition_strategy_7" value="文章摘要練習" class="text-orange-600 focus:ring-orange-500 mt-1">
                                    <span class="text-sm text-gray-700">文章摘要練習</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 創建數學能力策略內容
        function createMathAbilityStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 教材與教法調整 -->
                        <div class="bg-indigo-50 p-4 rounded-lg">
                            <h5 class="font-medium text-indigo-800 mb-2">教材與教法調整</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_1" value="簡化教材" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">簡化教材</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_2" value="調整作業內容份量或方式" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">調整作業內容份量或方式</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_3" value="以圖示協助" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">以圖示協助</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_4" value="多舉例說明" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">多舉例說明</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_5" value="背誦公式" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">背誦公式</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_6" value="利用小組比賽提升機會" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">利用小組比賽提升機會</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="math_teaching_adjustment_7" value="小教師協助" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">小教師協助</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 創建認知能力策略內容
        function createCognitiveStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 注意力教學調整 -->
                        <div class="bg-lime-50 p-4 rounded-lg">
                            <h5 class="font-medium text-lime-800 mb-2">注意力教學調整</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_1" value="安排有利座位" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">安排有利座位</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_2" value="利用聲調高低提高注意力" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">利用聲調高低提高注意力</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_3" value="安排同學提醒" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">安排同學提醒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_4" value="一次呈現較少問題" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">一次呈現較少問題</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_5" value="以肢體動作提醒學生專注" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">以肢體動作提醒學生專注</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_6" value="教師隨時提醒" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">教師隨時提醒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_7" value="物品依序排列" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">物品依序排列</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_8" value="桌面保持整潔" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">桌面保持整潔</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_9" value="口頭鼓勵" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">口頭鼓勵</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_10" value="容許工作中間短暫的休息" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">容許工作中間短暫的休息</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="attention_teaching_11" value="增強制度" class="text-lime-600 focus:ring-lime-500 mt-1">
                                    <span class="text-sm text-gray-700">增強制度</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 記憶力教學調整 -->
                        <div class="bg-sky-50 p-4 rounded-lg">
                            <h5 class="font-medium text-sky-800 mb-2">記憶力教學調整</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_1" value="提供背誦的口訣" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">提供背誦的口訣</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_2" value="對於缺交的功課持續追蹤" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">對於缺交的功課持續追蹤</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_3" value="畫重點提醒、做筆記" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">畫重點提醒、做筆記</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_4" value="默唸或小聲唸" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">默唸或小聲唸</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_5" value="簡化教材" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">簡化教材</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_6" value="圖像記憶法" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">圖像記憶法</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_7" value="請小教師協助" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">請小教師協助</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_8" value="給予書面提醒" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">給予書面提醒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_9" value="個別指導" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">個別指導</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_10" value="口頭鼓勵" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">口頭鼓勵</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_11" value="增強制度" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">增強制度</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="memory_teaching_12" value="反覆練習" class="text-sky-600 focus:ring-sky-500 mt-1">
                                    <span class="text-sm text-gray-700">反覆練習</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- 思考力教學調整 -->
                        <div class="bg-amber-50 p-4 rounded-lg">
                            <h5 class="font-medium text-amber-800 mb-2">思考力教學調整</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="thinking_teaching_1" value="多提供回答的機會" class="text-amber-600 focus:ring-amber-500 mt-1">
                                    <span class="text-sm text-gray-700">多提供回答的機會</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="thinking_teaching_2" value="將複雜的指令簡化" class="text-amber-600 focus:ring-amber-500 mt-1">
                                    <span class="text-sm text-gray-700">將複雜的指令簡化</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="thinking_teaching_3" value="提供實例說明" class="text-amber-600 focus:ring-amber-500 mt-1">
                                    <span class="text-sm text-gray-700">提供實例說明</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="thinking_teaching_other" value="其他" class="text-amber-600 focus:ring-amber-500 mt-1" onchange="toggleOtherInput('thinking_teaching_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="thinking_teaching_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 創建行為管理策略內容
        function createBehaviorManagementStrategies() {
            return `
                <div>
                    <h4 class="text-md font-medium text-gray-700 mb-3">您曾使用過的介入輔導方式(只是記錄，沒有也無須自責喔)</h4>
                    <div class="space-y-4">
                        <!-- 班級經營 -->
                        <div class="bg-indigo-50 p-4 rounded-lg">
                            <h5 class="font-medium text-indigo-800 mb-2">班級經營</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_1" value="友善班級經營" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">友善班級經營</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_2" value="合作學習小組制約、額外加分" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">合作學習小組制約、額外加分</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_3" value="引導同儕支持" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">引導同儕支持</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_4" value="暫時隔離" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">暫時隔離</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_5" value="建立同儕影響與支持" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">建立同儕影響與支持</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_6" value="預防衝突狀況發生" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">預防衝突狀況發生</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_7" value="設置個別學習區" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">設置個別學習區</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_8" value="調整教室規則" class="text-indigo-600 focus:ring-indigo-500 mt-1">
                                    <span class="text-sm text-gray-700">調整教室規則</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="classroom_management_other" value="其他" class="text-indigo-600 focus:ring-indigo-500 mt-1" onchange="toggleOtherInput('classroom_management_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="classroom_management_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                        
                        <!-- 行為改變技術 -->
                        <div class="bg-pink-50 p-4 rounded-lg">
                            <h5 class="font-medium text-pink-800 mb-2">行為改變技術</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_1" value="對於問題行為給予提示與緩衝" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">對於問題行為給予提示與緩衝</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_2" value="代幣制度、增強系統" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">代幣制度、增強系統</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_3" value="正向行為支持" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">正向行為支持</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_4" value="自我提示訓練" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">自我提示訓練</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_5" value="忽視問題行為並鼓勵正向行為" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">忽視問題行為並鼓勵正向行為</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_6" value="提示規則" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">提示規則</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_7" value="注意力訓練" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">注意力訓練</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_8" value="堅持對行為的要求及獎懲" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">堅持對行為的要求及獎懲</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_9" value="行為契約" class="text-pink-600 focus:ring-pink-500 mt-1">
                                    <span class="text-sm text-gray-700">行為契約</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="behavior_change_other" value="其他" class="text-pink-600 focus:ring-pink-500 mt-1" onchange="toggleOtherInput('behavior_change_other_text', this.checked)">
                                    <span class="text-sm text-gray-700">其他：</span>
                                </label>
                                <input type="text" name="behavior_change_other_text" class="w-full px-2 py-1 text-sm border border-gray-300 rounded hidden" placeholder="請說明...">
                            </div>
                        </div>
                        
                        <!-- 心理諮商輔導 -->
                        <div class="bg-teal-50 p-4 rounded-lg">
                            <h5 class="font-medium text-teal-800 mb-2">心理諮商輔導</h5>
                            <div class="space-y-1">
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_1" value="教導放鬆方法" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">教導放鬆方法</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_2" value="建立自我指導語" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">建立自我指導語</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_3" value="學習自我控制" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">學習自我控制</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_4" value="指導問題解決方法" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">指導問題解決方法</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_5" value="指導如何溝通自我負面情緒" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">指導如何溝通自我負面情緒</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_6" value="申請小團體輔導" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">申請小團體輔導</span>
                                </label>
                                <label class="flex items-start space-x-2 cursor-pointer">
                                    <input type="checkbox" name="counseling_7" value="尋找校內資源協助（認輔老師、專輔教師）" class="text-teal-600 focus:ring-teal-500 mt-1">
                                    <span class="text-sm text-gray-700">尋找校內資源協助（認輔老師、專輔教師）</span>
                                </label>
                            </div>
                        </div>
                        
                    </div>
                </div>
            `;
        }

        // 處理選項變更
        function handleOptionChange(dimensionId, value, isCheckbox = false, optionIndex = null) {
            const otherDiv = document.getElementById(dimensionId + '_other');
            
            // 處理原有的其他選項文字區域
            if (value.includes('其他') && otherDiv) {
                otherDiv.classList.remove('hidden');
                otherDiv.classList.add('fade-in');
            } else if (!isCheckbox && otherDiv) {
                otherDiv.classList.add('hidden');
            }
            
            // 處理新的內嵌其他選項輸入框
            if (value.includes('其他') || value === '其他') {
                const otherInput = document.querySelector(`input[name="${dimensionId}_other_${optionIndex}_text"]`);
                if (otherInput) {
                    otherInput.classList.remove('hidden');
                    otherInput.classList.add('fade-in');
                }
            }
            
            // 如果取消選擇其他選項，隱藏對應的輸入框
            if ((value.includes('其他') || value === '其他') && optionIndex !== null) {
                const checkbox = document.querySelector(`input[name="${dimensionId}_${optionIndex}"]`);
                const otherInput = document.querySelector(`input[name="${dimensionId}_other_${optionIndex}_text"]`);
                if (checkbox && otherInput && !checkbox.checked) {
                    otherInput.classList.add('hidden');
                    otherInput.value = '';
                }
            }
            
            // 如果是複選框且選擇了"無以下問題"，則取消其他選項
            if (isCheckbox && value === '無以下問題') {
                const checkboxes = document.querySelectorAll(`input[name^="${dimensionId}_"]`);
                checkboxes.forEach(checkbox => {
                    if (checkbox.value !== '無以下問題') {
                        checkbox.checked = false;
                        // 同時隱藏對應的其他選項輸入框
                        const inputName = checkbox.name;
                        const index = inputName.split('_').pop();
                        const otherInput = document.querySelector(`input[name="${dimensionId}_other_${index}_text"]`);
                        if (otherInput) {
                            otherInput.classList.add('hidden');
                            otherInput.value = '';
                        }
                    }
                });
            }
            
            // 如果選擇了其他選項，則取消"無以下問題"
            if (isCheckbox && value !== '無以下問題') {
                const noProblemsCheckbox = document.querySelector(`input[name^="${dimensionId}_"][value="無以下問題"]`);
                if (noProblemsCheckbox) {
                    noProblemsCheckbox.checked = false;
                }
            }
        }

        // 切換其他選項的文字輸入框
        function toggleOtherInput(inputId, isChecked) {
            const input = document.querySelector(`input[name="${inputId}"]`);
            if (input) {
                if (isChecked) {
                    input.classList.remove('hidden');
                    input.classList.add('fade-in');
                } else {
                    input.classList.add('hidden');
                    input.value = '';
                }
            }
        }

        // 處理認知能力選項變更
        function handleCognitiveOptionChange(category, value, optionIndex) {
            if (value === '無以下問題') {
                // 如果選擇了"無以下問題"，取消該類別的其他選項
                const checkboxes = document.querySelectorAll(`input[name^="${category}_"]`);
                checkboxes.forEach(checkbox => {
                    if (checkbox.value !== '無以下問題') {
                        checkbox.checked = false;
                    }
                });
            } else {
                // 如果選擇了其他選項，取消該類別的"無以下問題"
                const noProblemsCheckbox = document.querySelector(`input[name^="${category}_"][value="無以下問題"]`);
                if (noProblemsCheckbox) {
                    noProblemsCheckbox.checked = false;
                }
            }
            
            // 處理其他選項的文字輸入框
            if (value.includes('其他') || value === '其他') {
                const otherInput = document.querySelector(`input[name="${category}_other_${optionIndex}_text"]`);
                if (otherInput) {
                    const checkbox = document.querySelector(`input[name="${category}_${optionIndex}"]`);
                    if (checkbox && checkbox.checked) {
                        otherInput.classList.remove('hidden');
                        otherInput.classList.add('fade-in');
                    } else {
                        otherInput.classList.add('hidden');
                        otherInput.value = '';
                    }
                }
            }
        }

        // 處理國語能力選項變更
        function handleChineseAbilityOptionChange(category, value, optionIndex) {
            if (value === '無以下問題') {
                // 如果選擇了"無以下問題"，取消該類別的其他選項
                const checkboxes = document.querySelectorAll(`input[name^="${category}_"]`);
                checkboxes.forEach(checkbox => {
                    if (checkbox.value !== '無以下問題') {
                        checkbox.checked = false;
                    }
                });
            } else {
                // 如果選擇了其他選項，取消該類別的"無以下問題"
                const noProblemsCheckbox = document.querySelector(`input[name^="${category}_"][value="無以下問題"]`);
                if (noProblemsCheckbox) {
                    noProblemsCheckbox.checked = false;
                }
            }
        }

        // 處理口語表達選項變更
        function handleOralExpressionChange(value, isChecked) {
            if (value === '無以下問題' && isChecked) {
                // 如果選擇了"無以下問題"，取消其他所有選項
                for (let i = 1; i <= 8; i++) {
                    const checkbox = document.querySelector(`input[name="oral_expression_${i}"]`);
                    if (checkbox) {
                        checkbox.checked = false;
                    }
                }
            } else if (value !== '無以下問題' && isChecked) {
                // 如果選擇了其他選項，取消"無以下問題"
                const noProblemsCheckbox = document.querySelector(`input[name="oral_expression_0"]`);
                if (noProblemsCheckbox) {
                    noProblemsCheckbox.checked = false;
                }
            }
        }



        // 匯出資料
        function exportData() {
            const formData = new FormData(document.getElementById('assessmentForm'));
            const data = {
                基本資料: {
                    學生姓名: formData.get('studentName') || document.getElementById('studentName').value,
                    班級: formData.get('studentClass') || document.getElementById('studentClass').value,
                    座號: formData.get('studentId') || document.getElementById('studentId').value,
                    教師輔導介入日期: formData.get('interventionDate') || document.getElementById('interventionDate').value,
                    填表日期: formData.get('assessmentDate') || document.getElementById('assessmentDate').value,
                    填表教師: formData.get('teacherName') || document.getElementById('teacherName').value
                },
                評估結果: {}
            };

            // 收集評估資料
            // 處理班級常規表現
            const classroomDimension = dimensions.classroomBehavior;
            let classroomValues = [];
            const classroomTextValue = formData.get(classroomDimension.id + '_text');
            
            classroomDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(classroomDimension.id + '_' + index);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(classroomDimension.id + '_other_' + index + '_text');
                        classroomValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        classroomValues.push(checkboxValue);
                    }
                }
            });
            
            data.評估結果[classroomDimension.title] = {
                評估結果: classroomValues.length > 0 ? classroomValues.join('、') : '未填寫',
                詳細說明: classroomTextValue || '',
                其他補充: formData.get(classroomDimension.id + '_additional_notes') || ''
            };

            // 處理情緒行為評估
            const emotionalDimension = dimensions.emotionalBehavior;
            let emotionalValues = [];
            const emotionalTextValue = formData.get(emotionalDimension.id + '_text');
            
            emotionalDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(emotionalDimension.id + '_' + index);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(emotionalDimension.id + '_other_' + index + '_text');
                        emotionalValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        emotionalValues.push(checkboxValue);
                    }
                }
            });
            
            data.評估結果[emotionalDimension.title] = {
                評估結果: emotionalValues.length > 0 ? emotionalValues.join('、') : '未填寫',
                詳細說明: emotionalTextValue || '',
                其他補充: formData.get(emotionalDimension.id + '_additional_notes') || ''
            };

            // 處理憂鬱焦慮評估
            const mentalHealthDimension = dimensions.mentalHealth;
            let mentalHealthValues = [];
            const mentalHealthTextValue = formData.get(mentalHealthDimension.id + '_text');
            
            mentalHealthDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(mentalHealthDimension.id + '_' + index);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(mentalHealthDimension.id + '_other_' + index + '_text');
                        mentalHealthValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        mentalHealthValues.push(checkboxValue);
                    }
                }
            });
            
            data.評估結果[mentalHealthDimension.title] = {
                評估結果: mentalHealthValues.length > 0 ? mentalHealthValues.join('、') : '未填寫',
                詳細說明: mentalHealthTextValue || '',
                其他補充: formData.get(mentalHealthDimension.id + '_additional_notes') || ''
            };

            // 處理人際關係評估
            const interpersonalDimension = dimensions.interpersonal;
            let interpersonalValues = [];
            const interpersonalTextValue = formData.get(interpersonalDimension.id + '_text');
            
            interpersonalDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(interpersonalDimension.id + '_' + index);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(interpersonalDimension.id + '_other_' + index + '_text');
                        interpersonalValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        interpersonalValues.push(checkboxValue);
                    }
                }
            });
            
            data.評估結果[interpersonalDimension.title] = {
                評估結果: interpersonalValues.length > 0 ? interpersonalValues.join('、') : '未填寫',
                詳細說明: interpersonalTextValue || '',
                其他補充: formData.get(interpersonalDimension.id + '_additional_notes') || ''
            };

            // 處理溝通能力評估
            const communicationDimension = dimensions.communication;
            let communicationValues = [];
            const communicationTextValue = formData.get(communicationDimension.id + '_text');
            
            // 聽覺理解
            communicationDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(communicationDimension.id + '_' + index);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(communicationDimension.id + '_other_' + index + '_text');
                        communicationValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        communicationValues.push(checkboxValue);
                    }
                }
            });
            
            // 慣用語言
            const preferredLanguages = [];
            ['mandarin', 'hakka', 'taiwanese', 'indigenous'].forEach(lang => {
                const langValue = formData.get(`preferred_language_${lang}`);
                if (langValue) preferredLanguages.push(langValue);
            });
            if (formData.get('preferred_language_other')) {
                const otherLang = formData.get('preferred_language_other_text');
                preferredLanguages.push(otherLang ? `其他：${otherLang}` : '其他');
            }
            
            // 非口語溝通
            const nonverbalCommunication = [];
            ['gesture', 'writing', 'expression', 'nodding'].forEach(type => {
                const typeValue = formData.get(`nonverbal_${type}`);
                if (typeValue) nonverbalCommunication.push(typeValue);
            });
            if (formData.get('nonverbal_other')) {
                const otherNonverbal = formData.get('nonverbal_other_text');
                nonverbalCommunication.push(otherNonverbal ? `其他：${otherNonverbal}` : '其他');
            }
            
            // 口語表達問題
            const oralExpressionProblems = [];
            for (let i = 0; i <= 8; i++) {
                const problemValue = formData.get(`oral_expression_${i}`);
                if (problemValue) oralExpressionProblems.push(problemValue);
            }
            
            let communicationResult = '';
            if (communicationValues.length > 0) {
                communicationResult += `聽覺理解：${communicationValues.join('、')}`;
            }
            if (preferredLanguages.length > 0) {
                communicationResult += (communicationResult ? '；' : '') + `慣用語言：${preferredLanguages.join('、')}`;
            }
            if (nonverbalCommunication.length > 0) {
                communicationResult += (communicationResult ? '；' : '') + `非口語溝通：${nonverbalCommunication.join('、')}`;
            }
            if (oralExpressionProblems.length > 0) {
                communicationResult += (communicationResult ? '；' : '') + `口語表達：${oralExpressionProblems.join('、')}`;
            }
            
            data.評估結果[communicationDimension.title] = {
                評估結果: communicationResult || '未填寫',
                詳細說明: communicationTextValue || '',
                其他補充: formData.get(communicationDimension.id + '_additional_notes') || ''
            };

            // 處理認知能力評估
            const cognitiveResult = [];
            
            // 注意力
            const attentionValues = [];
            dimensions.cognitive.subCategories.attention.options.forEach((option, index) => {
                const checkboxValue = formData.get(`attention_${index}`);
                if (checkboxValue) attentionValues.push(checkboxValue);
            });
            if (attentionValues.length > 0) {
                cognitiveResult.push(`注意力：${attentionValues.join('、')}`);
            }
            
            // 記憶力
            const memoryValues = [];
            dimensions.cognitive.subCategories.memory.options.forEach((option, index) => {
                const checkboxValue = formData.get(`memory_${index}`);
                if (checkboxValue) memoryValues.push(checkboxValue);
            });
            if (memoryValues.length > 0) {
                cognitiveResult.push(`記憶力：${memoryValues.join('、')}`);
            }
            
            // 思考力
            const thinkingValues = [];
            dimensions.cognitive.subCategories.thinking.options.forEach((option, index) => {
                const checkboxValue = formData.get(`thinking_${index}`);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(`thinking_other_${index}_text`);
                        thinkingValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        thinkingValues.push(checkboxValue);
                    }
                }
            });
            if (thinkingValues.length > 0) {
                cognitiveResult.push(`思考力：${thinkingValues.join('、')}`);
            }
            
            data.評估結果[dimensions.cognitive.title] = {
                評估結果: cognitiveResult.length > 0 ? cognitiveResult.join('；') : '未填寫',
                詳細說明: '',
                其他補充: formData.get('cognitive_additional_notes') || ''
            };

            // 處理知覺動作評估
            const perceptualMotorDimension = dimensions.perceptualMotor;
            let perceptualMotorValues = [];
            const perceptualMotorTextValue = formData.get(perceptualMotorDimension.id + '_text');
            
            perceptualMotorDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(perceptualMotorDimension.id + '_' + index);
                if (checkboxValue) {
                    if (option.includes('其他') || option === '其他') {
                        const otherText = formData.get(perceptualMotorDimension.id + '_other_' + index + '_text');
                        perceptualMotorValues.push(otherText ? `${option}：${otherText}` : option);
                    } else {
                        perceptualMotorValues.push(checkboxValue);
                    }
                }
            });
            
            data.評估結果[perceptualMotorDimension.title] = {
                評估結果: perceptualMotorValues.length > 0 ? perceptualMotorValues.join('、') : '未填寫',
                詳細說明: perceptualMotorTextValue || '',
                其他補充: formData.get(perceptualMotorDimension.id + '_additional_notes') || ''
            };

            // 處理國語能力評估
            const chineseAbilityResult = [];
            
            // 閱讀
            const readingValues = [];
            dimensions.chineseAbility.subCategories.reading.options.forEach((option, index) => {
                const checkboxValue = formData.get(`reading_${index}`);
                if (checkboxValue) readingValues.push(checkboxValue);
            });
            if (readingValues.length > 0) {
                chineseAbilityResult.push(`閱讀：${readingValues.join('、')}`);
            }
            
            // 拼音
            const phonicsValues = [];
            dimensions.chineseAbility.subCategories.phonics.options.forEach((option, index) => {
                const checkboxValue = formData.get(`phonics_${index}`);
                if (checkboxValue) {
                    let phonicsDetail = checkboxValue;
                    
                    // 處理注音符號認讀困難的細項
                    if (option === '01.注音符號認讀困難') {
                        const subOptions = [];
                        if (formData.get('phonics_recognition_consonant')) subOptions.push('聲符');
                        if (formData.get('phonics_recognition_vowel')) subOptions.push('韻符');
                        if (formData.get('phonics_recognition_combination')) subOptions.push('結合符');
                        if (subOptions.length > 0) {
                            phonicsDetail += `（${subOptions.join('、')}）`;
                        }
                    }
                    
                    // 處理拼音困難的細項
                    if (option === '02.拼音困難') {
                        const subOptions = [];
                        if (formData.get('phonics_difficulty_double')) subOptions.push('雙拼');
                        if (formData.get('phonics_difficulty_triple')) subOptions.push('三拼');
                        if (subOptions.length > 0) {
                            phonicsDetail += `（${subOptions.join('、')}）`;
                        }
                    }
                    
                    // 處理拼音聽寫困難的細項
                    if (option === '04.拼音聽寫困難') {
                        const subOptions = [];
                        if (formData.get('phonics_dictation_double')) subOptions.push('雙拼');
                        if (formData.get('phonics_dictation_triple')) subOptions.push('三拼');
                        if (subOptions.length > 0) {
                            phonicsDetail += `（${subOptions.join('、')}）`;
                        }
                    }
                    
                    phonicsValues.push(phonicsDetail);
                }
            });
            if (phonicsValues.length > 0) {
                chineseAbilityResult.push(`拼音：${phonicsValues.join('、')}`);
            }
            
            // 寫字
            const writingValues = [];
            dimensions.chineseAbility.subCategories.writing.options.forEach((option, index) => {
                const checkboxValue = formData.get(`writing_${index}`);
                if (checkboxValue) writingValues.push(checkboxValue);
            });
            if (writingValues.length > 0) {
                chineseAbilityResult.push(`寫字：${writingValues.join('、')}`);
            }
            
            // 寫作
            const compositionValues = [];
            dimensions.chineseAbility.subCategories.composition.options.forEach((option, index) => {
                const checkboxValue = formData.get(`composition_${index}`);
                if (checkboxValue) compositionValues.push(checkboxValue);
            });
            if (compositionValues.length > 0) {
                chineseAbilityResult.push(`寫作：${compositionValues.join('、')}`);
            }
            
            data.評估結果[dimensions.chineseAbility.title] = {
                評估結果: chineseAbilityResult.length > 0 ? chineseAbilityResult.join('；') : '未填寫',
                詳細說明: '',
                其他補充: formData.get('chineseAbility_additional_notes') || ''
            };

            // 處理數學能力評估
            const mathAbilityDimension = dimensions.mathAbility;
            let mathAbilityValues = [];
            
            mathAbilityDimension.options.forEach((option, index) => {
                const checkboxValue = formData.get(mathAbilityDimension.id + '_' + index);
                if (checkboxValue) {
                    mathAbilityValues.push(checkboxValue);
                }
            });
            
            data.評估結果[mathAbilityDimension.title] = {
                評估結果: mathAbilityValues.length > 0 ? mathAbilityValues.join('、') : '未填寫',
                詳細說明: '',
                其他補充: formData.get(mathAbilityDimension.id + '_additional_notes') || ''
            };



            // 收集介入輔導方式資料
            const hasInterventionData = formData.get('academic_support_1') || formData.get('multilevel_teaching_1') || 
                                      formData.get('parent_education_1') || formData.get('other_strategy_description') ||
                                      formData.get('classroom_management_1') || formData.get('behavior_change_1') ||
                                      formData.get('counseling_1') || formData.get('other_behavior_strategy_description') ||
                                      formData.get('parent_education_mental_1') || formData.get('professional_intervention_1') ||
                                      formData.get('social_skills_1') || formData.get('other_interpersonal_strategy_description') ||
                                      formData.get('communication_training_1') || formData.get('other_communication_strategy_description');
            
            if (hasInterventionData) {
                data.介入輔導方式 = {};
                
                // 課業輔導
                const academicSupport = [];
                for (let i = 1; i <= 6; i++) {
                    const value = formData.get(`academic_support_${i}`);
                    if (value) academicSupport.push(value);
                }
                if (formData.get('academic_support_other')) {
                    const otherText = formData.get('academic_support_other_text');
                    academicSupport.push(`其他：${otherText || ''}`);
                }
                if (academicSupport.length > 0) {
                    data.介入輔導方式['課業輔導'] = academicSupport.join('、');
                }
                
                // 多層次教學
                const multilevelTeaching = [];
                for (let i = 1; i <= 13; i++) {
                    const value = formData.get(`multilevel_teaching_${i}`);
                    if (value) multilevelTeaching.push(value);
                }
                if (formData.get('multilevel_teaching_other')) {
                    const otherText = formData.get('multilevel_teaching_other_text');
                    multilevelTeaching.push(`其他：${otherText || ''}`);
                }
                if (multilevelTeaching.length > 0) {
                    data.介入輔導方式['多層次教學'] = multilevelTeaching.join('、');
                }
                
                // 親職教育
                const parentEducation = [];
                for (let i = 1; i <= 3; i++) {
                    const value = formData.get(`parent_education_${i}`);
                    if (value) parentEducation.push(value);
                }
                if (formData.get('parent_education_other')) {
                    const otherText = formData.get('parent_education_other_text');
                    parentEducation.push(`其他：${otherText || ''}`);
                }
                if (parentEducation.length > 0) {
                    data.介入輔導方式['親職教育'] = parentEducation.join('、');
                }
                
                // 班級經營
                const classroomManagement = [];
                for (let i = 1; i <= 8; i++) {
                    const value = formData.get(`classroom_management_${i}`);
                    if (value) classroomManagement.push(value);
                }
                if (formData.get('classroom_management_other')) {
                    const otherText = formData.get('classroom_management_other_text');
                    classroomManagement.push(`其他：${otherText || ''}`);
                }
                if (classroomManagement.length > 0) {
                    data.介入輔導方式['班級經營'] = classroomManagement.join('、');
                }
                
                // 行為改變技術
                const behaviorChange = [];
                for (let i = 1; i <= 9; i++) {
                    const value = formData.get(`behavior_change_${i}`);
                    if (value) behaviorChange.push(value);
                }
                if (formData.get('behavior_change_other')) {
                    const otherText = formData.get('behavior_change_other_text');
                    behaviorChange.push(`其他：${otherText || ''}`);
                }
                if (behaviorChange.length > 0) {
                    data.介入輔導方式['行為改變技術'] = behaviorChange.join('、');
                }
                
                // 心理諮商輔導
                const counseling = [];
                for (let i = 1; i <= 7; i++) {
                    const value = formData.get(`counseling_${i}`);
                    if (value) counseling.push(value);
                }
                if (counseling.length > 0) {
                    data.介入輔導方式['心理諮商輔導'] = counseling.join('、');
                }
                
                // 其他策略
                const otherStrategyDescription = formData.get('other_strategy_description');
                if (otherStrategyDescription && otherStrategyDescription.trim()) {
                    data.介入輔導方式['其他學習策略'] = otherStrategyDescription.trim();
                }
                
                // 其他行為策略
                const otherBehaviorStrategyDescription = formData.get('other_behavior_strategy_description');
                if (otherBehaviorStrategyDescription && otherBehaviorStrategyDescription.trim()) {
                    data.介入輔導方式['其他行為策略'] = otherBehaviorStrategyDescription.trim();
                }
                
                // 其他心理健康策略
                const otherMentalHealthStrategyDescription = formData.get('other_mental_health_strategy_description');
                if (otherMentalHealthStrategyDescription && otherMentalHealthStrategyDescription.trim()) {
                    data.介入輔導方式['其他心理健康策略'] = otherMentalHealthStrategyDescription.trim();
                }
                
                // 親職教育（心理健康）
                const parentEducationMental = [];
                for (let i = 1; i <= 7; i++) {
                    const value = formData.get(`parent_education_mental_${i}`);
                    if (value) parentEducationMental.push(value);
                }
                if (parentEducationMental.length > 0) {
                    data.介入輔導方式['親職教育（心理健康）'] = parentEducationMental.join('、');
                }
                
                // 專業介入
                const professionalIntervention = [];
                for (let i = 1; i <= 5; i++) {
                    const value = formData.get(`professional_intervention_${i}`);
                    if (value) professionalIntervention.push(value);
                }
                if (professionalIntervention.length > 0) {
                    data.介入輔導方式['專業介入'] = professionalIntervention.join('、');
                }
                
                // 社會技巧
                const socialSkills = [];
                for (let i = 1; i <= 13; i++) {
                    const value = formData.get(`social_skills_${i}`);
                    if (value) socialSkills.push(value);
                }
                if (formData.get('social_skills_other')) {
                    const otherText = formData.get('social_skills_other_text');
                    socialSkills.push(`其他：${otherText || ''}`);
                }
                if (socialSkills.length > 0) {
                    data.介入輔導方式['社會技巧'] = socialSkills.join('、');
                }
                
                // 其他人際關係策略
                const otherInterpersonalStrategyDescription = formData.get('other_interpersonal_strategy_description');
                if (otherInterpersonalStrategyDescription && otherInterpersonalStrategyDescription.trim()) {
                    data.介入輔導方式['其他人際關係策略'] = otherInterpersonalStrategyDescription.trim();
                }
                
                // 溝通訓練
                const communicationTraining = [];
                for (let i = 1; i <= 13; i++) {
                    const value = formData.get(`communication_training_${i}`);
                    if (value) communicationTraining.push(value);
                }
                if (formData.get('communication_training_other')) {
                    const otherText = formData.get('communication_training_other_text');
                    communicationTraining.push(`其他：${otherText || ''}`);
                }
                if (communicationTraining.length > 0) {
                    data.介入輔導方式['溝通訓練'] = communicationTraining.join('、');
                }
                
                // 其他溝通策略
                const otherCommunicationStrategyDescription = formData.get('other_communication_strategy_description');
                if (otherCommunicationStrategyDescription && otherCommunicationStrategyDescription.trim()) {
                    data.介入輔導方式['其他溝通策略'] = otherCommunicationStrategyDescription.trim();
                }
                
                // 注意力教學調整
                const attentionTeaching = [];
                for (let i = 1; i <= 11; i++) {
                    const value = formData.get(`attention_teaching_${i}`);
                    if (value) attentionTeaching.push(value);
                }
                if (attentionTeaching.length > 0) {
                    data.介入輔導方式['注意力教學調整'] = attentionTeaching.join('、');
                }
                
                // 記憶力教學調整
                const memoryTeaching = [];
                for (let i = 1; i <= 12; i++) {
                    const value = formData.get(`memory_teaching_${i}`);
                    if (value) memoryTeaching.push(value);
                }
                if (memoryTeaching.length > 0) {
                    data.介入輔導方式['記憶力教學調整'] = memoryTeaching.join('、');
                }
                
                // 思考力教學調整
                const thinkingTeaching = [];
                for (let i = 1; i <= 3; i++) {
                    const value = formData.get(`thinking_teaching_${i}`);
                    if (value) thinkingTeaching.push(value);
                }
                if (formData.get('thinking_teaching_other')) {
                    const otherText = formData.get('thinking_teaching_other_text');
                    thinkingTeaching.push(`其他：${otherText || ''}`);
                }
                if (thinkingTeaching.length > 0) {
                    data.介入輔導方式['思考力教學調整'] = thinkingTeaching.join('、');
                }
                
                // 其他認知策略
                const otherCognitiveStrategyDescription = formData.get('other_cognitive_strategy_description');
                if (otherCognitiveStrategyDescription && otherCognitiveStrategyDescription.trim()) {
                    data.介入輔導方式['其他認知策略'] = otherCognitiveStrategyDescription.trim();
                }
                
                // 功能性動作訓練
                const functionalMotorTraining = [];
                for (let i = 1; i <= 5; i++) {
                    const value = formData.get(`functional_motor_training_${i}`);
                    if (value) functionalMotorTraining.push(value);
                }
                if (formData.get('functional_motor_training_other')) {
                    const otherText = formData.get('functional_motor_training_other_text');
                    functionalMotorTraining.push(`其他：${otherText || ''}`);
                }
                if (functionalMotorTraining.length > 0) {
                    data.介入輔導方式['功能性動作訓練'] = functionalMotorTraining.join('、');
                }
                
                // 其他知覺動作策略
                const otherPerceptualMotorStrategyDescription = formData.get('other_perceptual_motor_strategy_description');
                if (otherPerceptualMotorStrategyDescription && otherPerceptualMotorStrategyDescription.trim()) {
                    data.介入輔導方式['其他知覺動作策略'] = otherPerceptualMotorStrategyDescription.trim();
                }
                
                // 閱讀學習策略
                const readingStrategy = [];
                for (let i = 1; i <= 6; i++) {
                    const value = formData.get(`reading_strategy_${i}`);
                    if (value) readingStrategy.push(value);
                }
                if (readingStrategy.length > 0) {
                    data.介入輔導方式['閱讀學習策略'] = readingStrategy.join('、');
                }
                
                // 拼音學習策略
                const phonicsStrategy = [];
                for (let i = 1; i <= 6; i++) {
                    const value = formData.get(`phonics_strategy_${i}`);
                    if (value) phonicsStrategy.push(value);
                }
                if (phonicsStrategy.length > 0) {
                    data.介入輔導方式['拼音學習策略'] = phonicsStrategy.join('、');
                }
                
                // 寫字學習策略
                const writingStrategy = [];
                for (let i = 1; i <= 5; i++) {
                    const value = formData.get(`writing_strategy_${i}`);
                    if (value) writingStrategy.push(value);
                }
                if (writingStrategy.length > 0) {
                    data.介入輔導方式['寫字學習策略'] = writingStrategy.join('、');
                }
                
                // 寫作學習策略
                const compositionStrategy = [];
                for (let i = 1; i <= 7; i++) {
                    const value = formData.get(`composition_strategy_${i}`);
                    if (value) compositionStrategy.push(value);
                }
                if (compositionStrategy.length > 0) {
                    data.介入輔導方式['寫作學習策略'] = compositionStrategy.join('、');
                }
                
                // 其他國語能力策略
                const otherChineseAbilityStrategyDescription = formData.get('other_chinese_ability_strategy_description');
                if (otherChineseAbilityStrategyDescription && otherChineseAbilityStrategyDescription.trim()) {
                    data.介入輔導方式['其他國語能力策略'] = otherChineseAbilityStrategyDescription.trim();
                }
                
                // 數學教材與教法調整
                const mathTeachingAdjustment = [];
                for (let i = 1; i <= 7; i++) {
                    const value = formData.get(`math_teaching_adjustment_${i}`);
                    if (value) mathTeachingAdjustment.push(value);
                }
                if (mathTeachingAdjustment.length > 0) {
                    data.介入輔導方式['數學教材與教法調整'] = mathTeachingAdjustment.join('、');
                }
                
                // 其他數學能力策略
                const otherMathAbilityStrategyDescription = formData.get('other_math_ability_strategy_description');
                if (otherMathAbilityStrategyDescription && otherMathAbilityStrategyDescription.trim()) {
                    data.介入輔導方式['其他數學能力策略'] = otherMathAbilityStrategyDescription.trim();
                }
            }

            // 驗證必填欄位
            if (!data.基本資料.學生姓名 || !data.基本資料.班級 || !data.基本資料.教師輔導介入日期 || !data.基本資料.填表日期 || !data.基本資料.填表教師) {
                showMessage('請填寫所有必填欄位（學生姓名、班級、教師輔導介入日期、填表日期、填表教師）', 'error');
                return;
            }

            // 生成報告內容
            let reportContent = `學生評估報告\n\n`;
            reportContent += `學生姓名：${data.基本資料.學生姓名}\n`;
            reportContent += `班級：${data.基本資料.班級}\n`;
            reportContent += `座號：${data.基本資料.座號}\n`;
            reportContent += `教師輔導介入日期：${data.基本資料.教師輔導介入日期}\n`;
            reportContent += `填表日期：${data.基本資料.填表日期}\n`;
            reportContent += `填表教師：${data.基本資料.填表教師}\n\n`;
            reportContent += `評估結果：\n`;
            
            Object.entries(data.評估結果).forEach(([key, value]) => {
                reportContent += `\n${key}\n`;
                reportContent += `評估：${value.評估結果}\n`;
                if (value.詳細說明) {
                    reportContent += `說明：${value.詳細說明}\n`;
                }
                if (value.其他補充) {
                    reportContent += `其他補充：${value.其他補充}\n`;
                }
            });

            // 添加介入輔導方式到報告
            if (data.介入輔導方式) {
                reportContent += `\n您曾使用過的介入輔導方式：\n`;
                Object.entries(data.介入輔導方式).forEach(([key, value]) => {
                    reportContent += `\n${key}：${value}\n`;
                });
            }

            // 下載檔案
            const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${data.基本資料.學生姓名}_評估報告_${data.基本資料.填表日期}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showMessage('評估報告已成功匯出！', 'success');
        }

        // 重設表單
        function resetForm() {
            // 使用自定義確認對話框
            showConfirmDialog('確定要清除所有資料重新填寫嗎？', () => {
                document.getElementById('assessmentForm').reset();
                
                // 隱藏所有其他選項的文字輸入區域
                const allOtherDivs = [
                    'classroomBehavior_other',
                    'emotionalBehavior_other',
                    'mentalHealth_other',
                    'interpersonal_other',
                    'communication_other',
                    'perceptualMotor_other'
                ];
                
                allOtherDivs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.classList.add('hidden');
                    }
                });
                
                // 隱藏所有其他選項的內嵌輸入框
                document.querySelectorAll('input[name*="_other_"][name*="_text"]').forEach(input => {
                    input.classList.add('hidden');
                    input.value = '';
                });
                
                showMessage('表單已重設', 'info');
            });
        }

        // 顯示確認對話框
        function showConfirmDialog(message, onConfirm) {
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            
            const dialog = document.createElement('div');
            dialog.className = 'bg-white rounded-lg p-6 max-w-sm mx-4 shadow-xl';
            
            dialog.innerHTML = `
                <h3 class="text-lg font-semibold text-gray-800 mb-4">確認操作</h3>
                <p class="text-gray-600 mb-6">${message}</p>
                <div class="flex justify-end space-x-3">
                    <button id="cancelBtn" class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50 transition-colors">取消</button>
                    <button id="confirmBtn" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors">確定</button>
                </div>
            `;
            
            overlay.appendChild(dialog);
            document.body.appendChild(overlay);
            
            document.getElementById('cancelBtn').onclick = () => {
                document.body.removeChild(overlay);
            };
            
            document.getElementById('confirmBtn').onclick = () => {
                document.body.removeChild(overlay);
                onConfirm();
            };
            
            // 點擊背景關閉
            overlay.onclick = (e) => {
                if (e.target === overlay) {
                    document.body.removeChild(overlay);
                }
            };
        }

        // 顯示訊息
        function showMessage(message, type) {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 fade-in`;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // 儲存資料到本地存儲
        function saveCurrentData() {
            const studentName = document.getElementById('studentName').value.trim();
            if (!studentName) {
                showMessage('請先輸入學生姓名', 'error');
                return;
            }
            
            const formData = new FormData(document.getElementById('assessmentForm'));
            const data = {};
            
            // 收集所有表單資料
            for (let [key, value] of formData.entries()) {
                if (key.includes('_file')) continue; // 跳過檔案欄位
                data[key] = value;
            }
            
            // 收集複選框資料
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                data[checkbox.name] = checkbox.checked;
            });
            
            // 收集基本資料
            data.studentName = document.getElementById('studentName').value;
            data.studentClass = document.getElementById('studentClass').value;
            data.studentId = document.getElementById('studentId').value;
            data.interventionDate = document.getElementById('interventionDate').value;
            data.assessmentDate = document.getElementById('assessmentDate').value;
            data.teacherName = document.getElementById('teacherName').value;
            
            // 儲存到 localStorage
            const savedData = JSON.parse(localStorage.getItem('studentAssessments') || '{}');
            savedData[studentName] = {
                data: data,
                savedDate: new Date().toISOString(),
                lastModified: new Date().toISOString()
            };
            localStorage.setItem('studentAssessments', JSON.stringify(savedData));
            
            showMessage(`${studentName} 的資料已儲存`, 'success');
        }
        
        // 檢查是否有已儲存的資料
        function checkForSavedData() {
            const studentName = document.getElementById('studentName').value.trim();
            if (!studentName) {
                hideSavedDataNotification();
                return;
            }
            
            const savedData = JSON.parse(localStorage.getItem('studentAssessments') || '{}');
            if (savedData[studentName]) {
                const notification = document.getElementById('savedDataNotification');
                const savedDate = new Date(savedData[studentName].savedDate).toLocaleDateString('zh-TW');
                notification.querySelector('p').textContent = `找到此學生的已儲存資料（儲存日期：${savedDate}）`;
                notification.classList.remove('hidden');
                notification.classList.add('fade-in');
            } else {
                hideSavedDataNotification();
            }
        }
        
        // 載入已儲存的資料
        function loadSavedData() {
            const studentName = document.getElementById('studentName').value.trim();
            const savedData = JSON.parse(localStorage.getItem('studentAssessments') || '{}');
            
            if (!savedData[studentName]) {
                showMessage('找不到已儲存的資料', 'error');
                return;
            }
            
            const data = savedData[studentName].data;
            
            // 載入基本資料
            if (data.studentName) document.getElementById('studentName').value = data.studentName;
            if (data.studentClass) document.getElementById('studentClass').value = data.studentClass;
            if (data.studentId) document.getElementById('studentId').value = data.studentId;
            if (data.interventionDate) document.getElementById('interventionDate').value = data.interventionDate;
            if (data.assessmentDate) document.getElementById('assessmentDate').value = data.assessmentDate;
            if (data.teacherName) document.getElementById('teacherName').value = data.teacherName;
            
            // 載入表單資料
            Object.entries(data).forEach(([key, value]) => {
                const element = document.querySelector(`[name="${key}"]`);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = value === true || value === 'true';
                    } else if (element.type === 'radio') {
                        if (element.value === value) {
                            element.checked = true;
                        }
                    } else if (element.tagName === 'TEXTAREA' || element.tagName === 'INPUT') {
                        element.value = value;
                    }
                }
            });
            
            // 載入複選框狀態
            Object.entries(data).forEach(([key, value]) => {
                if (typeof value === 'boolean') {
                    const checkbox = document.querySelector(`input[name="${key}"]`);
                    if (checkbox && checkbox.type === 'checkbox') {
                        checkbox.checked = value;
                        
                        // 處理其他選項的顯示/隱藏
                        if (value && (checkbox.value.includes('其他') || checkbox.value === '其他')) {
                            const parts = key.split('_');
                            const dimensionId = parts.slice(0, -1).join('_');
                            const optionIndex = parts[parts.length - 1];
                            const otherInput = document.querySelector(`input[name="${dimensionId}_other_${optionIndex}_text"]`);
                            if (otherInput) {
                                otherInput.classList.remove('hidden');
                            }
                        }
                    }
                }
            });
            
            hideSavedDataNotification();
            showMessage(`已載入 ${studentName} 的資料`, 'success');
        }
        
        // 隱藏已儲存資料通知
        function hideSavedDataNotification() {
            const notification = document.getElementById('savedDataNotification');
            notification.classList.add('hidden');
        }
        
        // 管理已儲存的資料
        function manageSavedData() {
            const savedData = JSON.parse(localStorage.getItem('studentAssessments') || '{}');
            const studentNames = Object.keys(savedData);
            
            if (studentNames.length === 0) {
                showMessage('目前沒有已儲存的資料', 'info');
                return;
            }
            
            let listHtml = '<h3 class="text-lg font-semibold mb-4">已儲存的學生資料</h3><div class="space-y-2">';
            studentNames.forEach(name => {
                const data = savedData[name];
                const savedDate = new Date(data.savedDate).toLocaleDateString('zh-TW');
                listHtml += `
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                        <div>
                            <span class="font-medium">${name}</span>
                            <span class="text-sm text-gray-500 ml-2">儲存於 ${savedDate}</span>
                        </div>
                        <div class="space-x-2">
                            <button onclick="loadSpecificData('${name}')" class="px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600">載入</button>
                            <button onclick="deleteSpecificData('${name}')" class="px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600">刪除</button>
                        </div>
                    </div>
                `;
            });
            listHtml += '</div>';
            
            showCustomDialog(listHtml);
        }
        
        // 載入特定學生資料
        function loadSpecificData(studentName) {
            document.getElementById('studentName').value = studentName;
            loadSavedData();
            closeCustomDialog();
        }
        
        // 刪除特定學生資料
        function deleteSpecificData(studentName) {
            showConfirmDialog(`確定要刪除 ${studentName} 的已儲存資料嗎？`, () => {
                const savedData = JSON.parse(localStorage.getItem('studentAssessments') || '{}');
                delete savedData[studentName];
                localStorage.setItem('studentAssessments', JSON.stringify(savedData));
                showMessage(`已刪除 ${studentName} 的資料`, 'success');
                closeCustomDialog();
                manageSavedData(); // 重新顯示列表
            });
        }
        
        // 顯示自定義對話框
        function showCustomDialog(content) {
            const overlay = document.createElement('div');
            overlay.id = 'customDialog';
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            
            const dialog = document.createElement('div');
            dialog.className = 'bg-white rounded-lg p-6 max-w-2xl max-h-96 overflow-y-auto mx-4 shadow-xl';
            
            dialog.innerHTML = `
                ${content}
                <div class="flex justify-end mt-6">
                    <button onclick="closeCustomDialog()" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors">關閉</button>
                </div>
            `;
            
            overlay.appendChild(dialog);
            document.body.appendChild(overlay);
            
            // 點擊背景關閉
            overlay.onclick = (e) => {
                if (e.target === overlay) {
                    closeCustomDialog();
                }
            };
        }
        
        // 關閉自定義對話框
        function closeCustomDialog() {
            const dialog = document.getElementById('customDialog');
            if (dialog) {
                document.body.removeChild(dialog);
            }
        }

        // 頁面載入時初始化
        document.addEventListener('DOMContentLoaded', initializeForm);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98f09595a0b08412',t:'MTc2MDU0NDYwMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
